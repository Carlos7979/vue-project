import{C as S,a as B}from"./CartPlusIcon-29b5d41a.js";import{B as E}from"./Button-37345bc4.js";import{T as q}from"./Trash-2a2d2564.js";import{S as f}from"./sweetalert2.all-4f073957.js";import{_ as R,m as v,a as C,f as l,r as o,o as u,c as h,i as m,v as _,b as e,d as n,F as T,g as U,t as c,j as V,p as b,e as x}from"./index-de7c6cf0.js";const{VITE_FOOD_URL:L,VITE_USER_URL:Q}={VITE_FOOD_URL:"https://649fd22fed3c41bdd7a6bb8d.mockapi.io/api/food",VITE_USER_URL:"https://649fbf32ed3c41bdd7a6a1d1.mockapi.io/api/food/users",BASE_URL:"/vue-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},D={name:"Cart",components:{CartMinusIconVue:S,CartPlusIcon:B,Trash:q,Button:E},data(){return{}},methods:{...v("cart",["setQuantity"]),...v("user",["addPurchase"]),handleShowInfo(t){this.$router.push({path:`/info/${t}`})},addQuantity(t){this.setQuantity(t)},removeQuantity(t){t.quantity>=0&&this.setQuantity(t)},emptyProduct(t){this.setQuantity(t)},sendProduct(t){return this.products.find(r=>r.id===t)},async confirmPurchase(){try{if((await f.fire({title:"Confirmación de compra",html:`¿Confirmas la compra de <b>${this.totalProducts}</b> producto${this.totalProducts>1?"s":""} por un monto total de <b>${this.totalAmount}</b>?`,footer:"Esta acción no puede revertirse",icon:"question",showCloseButton:!0,showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Comprar",reverseButtons:!0})).isConfirmed){const i=[{timestamp:Date.now(),products:this.cart},...this.orders];(await C.put(`${Q}/${this.user.id}`,{orders:i})).status===200&&(await C.put(`${L}carts/${this.user.cart}`,{cart:[]})).status===200&&(await f.fire({icon:"success",title:"La compra se ha realizado exitosamente",showConfirmButton:!1,timer:1500}),this.addPurchase(i))}}catch(t){console.log(t)}}},computed:{...l("product",["getProducts"]),...l("cart",["getCart"]),...l("user",["getOrders","getUser"]),totalProducts(){let t=0;return this.cart.forEach(r=>{t+=r.quantity}),t},totalAmount(){let t=0;return this.cart.forEach(r=>{t+=this.sendProduct(r.productId).price*r.quantity}),t},products(){return this.getProducts},cart(){return this.getCart},orders(){return this.getOrders},user(){return this.getUser}}},p=t=>(b("data-v-289f1699"),t=t(),x(),t),O={class:"cart"},A=V('<div class="cart-elements-header" data-v-289f1699><div class="cart-elements" data-v-289f1699><div class="cart-element t-header" data-v-289f1699>Producto</div><div class="cart-element t-header" data-v-289f1699>Precio</div><div class="cart-element t-header" data-v-289f1699>Cantidad</div><div class="cart-element t-header" data-v-289f1699>Total</div><div class="cart-element t-header" data-v-289f1699>Quitar</div></div></div>',1),F={class:"cart-elements"},M=["onClick"],N={class:"cart-element"},j={class:"cart-element"},z=["onClick"],G={class:"quantity"},$=["onClick"],H={class:"cart-element"},J=["onClick"],K={class:"cart-elements-header"},W={class:"cart-elements"},X=p(()=>e("div",{class:"cart-element t-header"},null,-1)),Y=p(()=>e("div",{class:"cart-element t-header"},null,-1)),Z={class:"cart-element t-header"},tt={class:"cart-element t-header"},et=p(()=>e("div",{class:"cart-element t-header"},null,-1)),st={class:"empty"};function at(t,r,i,y,I,s){const P=o("Button"),k=o("CartMinusIconVue"),w=o("CartPlusIcon"),g=o("Trash");return u(),h("div",null,[m(e("div",O,[n(P,{click:s.confirmPurchase,text:"Confirmar compra"},null,8,["click"]),A,(u(!0),h(T,null,U(s.cart,(a,d)=>(u(),h("div",{key:`${d}-product`},[m(e("div",F,[e("div",{onClick:()=>s.handleShowInfo(a.productId),class:"cart-element route"},c(s.sendProduct(a.productId).title),9,M),e("div",N,c(s.products[d].price),1),e("div",j,[e("span",{class:"click-cart",onClick:()=>s.removeQuantity({quantity:a.quantity-1,productId:a.productId})},[n(k)],8,z),e("span",G,c(a.quantity),1),e("span",{class:"click-cart",onClick:()=>s.addQuantity({quantity:a.quantity+1,productId:a.productId})},[n(w)],8,$)]),e("div",H,c(a.quantity*s.products[d].price),1),e("div",{class:"cart-element click-cart trash",onClick:()=>s.emptyProduct({quantity:0,productId:a.productId})},[n(g)],8,J)],512),[[_,a.quantity>0]])]))),128)),e("div",K,[e("div",W,[X,Y,e("div",Z,c(s.totalProducts),1),e("div",tt,c(s.totalAmount),1),et])])],512),[[_,s.cart.length]]),m(e("div",st,"El carrito de compras se encuentra vacío",512),[[_,!s.cart.length]])])}const dt=R(D,[["render",at],["__scopeId","data-v-289f1699"]]);export{dt as default};
