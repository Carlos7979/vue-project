import{I as f}from"./Input-dbfb707b.js";import{S as _}from"./sweetalert2.all-4f073957.js";import{_ as I,m as g,a as i,f as b,r as d,o as x,c as v,b as a,d as n,t as y,n as V,w as P,p as k,e as w}from"./index-e2bbd2e5.js";const l="https://649fd22fed3c41bdd7a6bb8d.mockapi.io/api/food",S={name:"ManageProduct",components:{Input:f},props:{},data(){return{form:{title:"",img:"",shortDescription:"",largeDescription:"",price:"",stock:""},isSubmitted:!1,error:!1}},methods:{...g("product",["updateProducts"]),handleInput([e,r]){this.form[e]=r},validate(){const e=this.$refs.error;for(const r in this.form)if(!this.form[r])return e.innerText="Todos los campos son obligatorios",this.error||(this.error=!0),!1;return!0},handleUpdateProducts(e){this.updateProducts(e)}},mounted(){if(this.product)for(const r in this.product)this.handleInput([r,this.product[r]]);this.$refs.form.addEventListener("submit",async r=>{r.preventDefault(),this.isSubmitted=!0;try{if(this.validate()){const c={...this.form};let s,u;if(this.$route.name==="new-product")s=await i.post(`${l}/products`,c),u="create";else{const o=this.$route.params.id;s=await i.put(`${l}/products/${o}`,c),u="update"}const t=s.status;s=s.data,_.fire({icon:"success",title:`Producto ${t===201?"creado":"actualizado"} exitosamente`,showConfirmButton:!1,timer:1500}).then(()=>{this.handleUpdateProducts({action:t===201?"create":"update",product:s}),this.isSubmitted=!1})}}catch(c){console.log(c)}})},computed:{...b("product",["getProductById"]),product(){return this.$route.name==="edit-product"?this.getProductById(this.$route.params.id):{}}}},p=e=>(k("data-v-c694acca"),e=e(),w(),e),D={class:"manage-product-container"},B={class:"manage-product"},L={ref:"form",action:"",method:"post"},C={class:"btn form-control text-bg-dark p-3"},U=p(()=>a("button",{class:"btn form-control text-bg-primary mt-2"},"Volver",-1)),z={class:"manage-product url-preview"},A=p(()=>a("div",{class:"preview-title"},"Vista previa de la imagen",-1)),M=["src"];function R(e,r,c,s,u,t){const o=d("Input"),m=d("RouterLink");return x(),v("div",D,[a("div",B,[a("form",L,[n(o,{label:"Título:",type:"text",id:"title",placeholder:"Selva negra...",textValue:t.product?.title,onInput:t.handleInput},null,8,["textValue","onInput"]),n(o,{label:"Url de la imagen:",type:"text",id:"img",placeholder:"https://...",textValue:t.product.img,onInput:t.handleInput},null,8,["textValue","onInput"]),n(o,{label:"Descripción corta",type:"textarea",max:"95",id:"shortDescription",placeholder:"...hasta 95 caracteres",textValue:t.product.shortDescription,onInput:t.handleInput},null,8,["textValue","onInput"]),n(o,{label:"Descripción larga",type:"textarea",id:"largeDescription",placeholder:"Introduce una descripción del producto...",textValue:t.product.largeDescription,onInput:t.handleInput},null,8,["textValue","onInput"]),n(o,{label:"Precio",type:"number",id:"price",placeholder:"200...",numberValue:t.product.price,min:"0",onInput:t.handleInput},null,8,["numberValue","onInput"]),n(o,{label:"Stock",type:"number",id:"stock",placeholder:"10...",numberValue:t.product.stock,min:"0",onInput:t.handleInput},null,8,["numberValue","onInput"]),a("button",C,y(e.$route.name==="new-product"?"Agregar Producto":"Actualizar Producto"),1),a("div",{ref:"error",class:V(u.error?"error":"")},null,2)],512),n(m,{to:"/admin"},{default:P(()=>[U]),_:1})]),a("div",z,[A,a("img",{src:u.form.img||t.product&&t.product.img,alt:"url-preview",onLoad:r[0]||(r[0]=h=>h.target.style.opacity=1)},null,40,M)])])}const G=I(S,[["render",R],["__scopeId","data-v-c694acca"]]);export{G as default};
