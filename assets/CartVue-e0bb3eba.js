import{C as g,a as k}from"./CartPlusIcon-20b52c17.js";import{B as w}from"./ButtonVue-a29579dd.js";import{T as S}from"./TrashVue-3ba92866.js";import{S as p}from"./sweetalert2.all-4f073957.js";import{_ as E,m as v,a as f,f as d,r as o,o as l,c as u,i as h,v as m,b as e,d as n,F as q,g as R,t as r,j as T,p as U,e as L}from"./index-c066fabd.js";const{VITE_FOOD_URL:Q,VITE_USER_URL:D}={VITE_FOOD_URL:"https://649fd22fed3c41bdd7a6bb8d.mockapi.io/api/food",VITE_USER_URL:"https://649fbf32ed3c41bdd7a6a1d1.mockapi.io/api/food/users",BASE_URL:"/vue-project/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},O={name:"Cart",components:{CartMinusIconVue:g,CartPlusIcon:k,TrashVue:S,ButtonVue:w},data(){return{}},methods:{...v("cart",["setQuantity"]),...v("user",["addPurchase"]),handleShowInfo(t){this.$router.push({path:`/info/${t}`})},addQuantity(t){this.setQuantity(t)},removeQuantity(t){t.quantity>=0&&this.setQuantity(t)},emptyProduct(t){this.setQuantity(t)},async confirmPurchase(){try{if((await p.fire({title:"Confirmación de compra",html:`¿Confirmas la compra de <b>${this.totalProducts}</b> producto${this.totalProducts>1?"s":""} por un monto total de <b>${this.totalAmount}</b>?`,footer:"Esta acción no puede revertirse",icon:"question",showCloseButton:!0,showCancelButton:!0,cancelButtonText:"Cancelar",confirmButtonText:"Comprar",reverseButtons:!0})).isConfirmed){const i=[{timestamp:Date.now(),products:this.cart},...this.orders];(await f.put(`${D}/${this.user.id}`,{orders:i})).status===200&&(await f.put(`${Q}carts/${this.user.cart}`,{cart:[]})).status===200&&(await p.fire({icon:"success",title:"La compra se ha realizado exitosamente",showConfirmButton:!1,timer:1500}),this.addPurchase(i))}}catch(t){console.log(t)}}},computed:{...d("product",["getProductById"]),...d("cart",["getCart"]),...d("user",["getOrders","getUser"]),totalProducts(){let t=0;return this.cart.forEach(c=>{t+=c.quantity}),t},totalAmount(){let t=0;return this.cart.forEach(c=>{t+=this.getProductById(c.productId).price*c.quantity}),t},cart(){return this.getCart},orders(){return this.getOrders},user(){return this.getUser}}},_=t=>(U("data-v-b2823c3c"),t=t(),L(),t),x={class:"cart"},A=T('<div class="cart-elements-header" data-v-b2823c3c><div class="cart-elements" data-v-b2823c3c><div class="cart-element t-header" data-v-b2823c3c>Producto</div><div class="cart-element t-header" data-v-b2823c3c>Precio</div><div class="cart-element t-header" data-v-b2823c3c>Cantidad</div><div class="cart-element t-header" data-v-b2823c3c>Total</div><div class="cart-element t-header" data-v-b2823c3c>Quitar</div></div></div>',1),F={class:"cart-elements"},M=["onClick"],$={class:"cart-element"},N={class:"cart-element"},j=["onClick"],z={class:"quantity"},G=["onClick"],H={class:"cart-element"},J=["onClick"],K={class:"cart-elements-header"},W={class:"cart-elements"},X=_(()=>e("div",{class:"cart-element t-header"},null,-1)),Y=_(()=>e("div",{class:"cart-element t-header"},null,-1)),Z={class:"cart-element t-header"},tt={class:"cart-element t-header"},et=_(()=>e("div",{class:"cart-element t-header"},null,-1)),at={class:"empty"};function st(t,c,i,y,I,s){const C=o("ButtonVue"),P=o("CartMinusIconVue"),b=o("CartPlusIcon"),B=o("TrashVue");return l(),u("div",null,[h(e("div",x,[n(C,{click:s.confirmPurchase,text:"Confirmar compra"},null,8,["click"]),A,(l(!0),u(q,null,R(s.cart,(a,V)=>(l(),u("div",{key:`${V}-product`},[h(e("div",F,[e("div",{onClick:()=>s.handleShowInfo(a.productId),class:"cart-element route"},r(t.getProductById(a.productId).title),9,M),e("div",$,r(t.getProductById(a.productId).price),1),e("div",N,[e("span",{class:"click-cart",onClick:()=>s.removeQuantity({quantity:a.quantity-1,productId:a.productId})},[n(P)],8,j),e("span",z,r(a.quantity),1),e("span",{class:"click-cart",onClick:()=>s.addQuantity({quantity:a.quantity+1,productId:a.productId})},[n(b)],8,G)]),e("div",H,r(a.quantity*t.getProductById(a.productId).price),1),e("div",{class:"cart-element click-cart trash",onClick:()=>s.emptyProduct({quantity:0,productId:a.productId})},[n(B)],8,J)],512),[[m,a.quantity>0]])]))),128)),e("div",K,[e("div",W,[X,Y,e("div",Z,r(s.totalProducts),1),e("div",tt,r(s.totalAmount),1),et])])],512),[[m,s.cart.length]]),h(e("div",at,"El carrito de compras se encuentra vacío",512),[[m,!s.cart.length]])])}const dt=E(O,[["render",st],["__scopeId","data-v-b2823c3c"]]);export{dt as default};
